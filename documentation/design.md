# System Design Documentation

The journal application is used to save journal and display user
journal entries.

- [System Design Documentation](#system-design-documentation)
- [Initial High Level Requirements](#initial-high-level-requirements)
  - [Core Functional Requirements](#core-functional-requirements)
  - [Domain Model Overview](#domain-model-overview)
  - [Journal Day Model](#journal-day-model)
  - [Journal Entry Model](#journal-entry-model)
  - [Tag Model](#tag-model)
  - [Data Integrity Rules](#data-integrity-rules)
  - [API Design](#api-design)
- [Data Modelling](#data-modelling)
  - [days](#days)
  - [entries](#entries)
  - [tags](#tags)


# Initial High Level Requirements

## Core Functional Requirements
- Create or overwrite a journal day
- Retrieve journal days by date or date range
- Delete journal days by date or date range
- All create and overwrite operations support batch input
- Batch operations are atomic (all succeed or all fail)

## Domain Model Overview
- The primary aggregate is a journal day
- A journal day represents one calendar date
- A journal day owns journal entries and tags
- Journal entries and tags cannot exist without a journal day

## Journal Day Model
Each journal day contains:
- date: unique identifier for the day (YYYY-MM-DD)
- state: COMPLETED | NONE | INCOMPLETE
- points: optional total points for the day
- entries: ordered list of journal entries
- tags: optional list of manual tags associated with the day

## Journal Entry Model
Each journal entry contains:
- id: generated by service or database
- sequence: ordering within the day
- points: optional numeric value
- text: entry content
- date: foreign key referencing the journal day

## Tag Model
Each tag contains:
- id: generated unique identifier
- tag: string value
- date: foreign key referencing the journal day

## Data Integrity Rules
- A journal day is uniquely identified by its date
- Journal entry ordering is defined by sequence within a day
- Entries are uniquely identified by date and sequence
- Tags are uniquely identified by date and tag value
- Overwriting a journal day replaces all existing entries and tags
- Day completion is represented by state

## API Design
- Base path: /api/journal/days
- POST endpoint creates or overwrites journal days
- GET endpoint retrieves journal days by date or date range
- DELETE endpoint removes journal days by date or date range
- Journal days are the unit of creation, retrieval, and deletion


# Data Modelling

Days Table

  days
  -----
  date        PK
  state       ENUM(COMPLETED, NONE, INCOMPLETE)
  points      INT


Entries Table

  entries
  -------
  id          PK
  text        TEXT
  points      INT NULL
  date        FK → days.date
  sequence    INT

Tags Table

  tags
  ----
  id          PK
  date        FK → days.date
  tag         VARCHAR
